###
###
###

# WARNING:  this file is auto-generated.  changes will be discarded on
# next chef-client run.

allow booting;
allow bootp;
ddns-update-style none;
option domain-name "pfsl.mech.tohoku.ac.jp";
option domain-search "pfsl.mech.tohoku.ac.jp";
option domain-name-servers 10.8.11.2;
default-lease-time 31557600;
max-lease-time 31557600;
log-facility local7;
use-host-decl-names on;

subnet 10.90.0.0 netmask 255.255.0.0 {
  authoritative;

  option broadcast-address 10.90.255.255;
  option routers <%= @routers.map(&:banananet_ipaddress).join(", ") %>;

  group {
    filename "pxelinux.0";
    server-name "<%= node.banananet_ipaddress %>";
    <% @tftp_servers.each do |tftp_server| %>
    next-server <%= tftp_server.banananet_ipaddress %>;
    <% end %>
    <% ::Banana.config.host_groups.each do |host_group| %>

    # <%= host_group.name %>
      <% host_group.hosts.each do |host| %>
    host <%= host.name %> { hardware ethernet <%= host.ethernet_address %>; fixed-address <%= host.ip_address %>; }
      <% end %>
    <% end %>

    # use /root/bin/dhcp-genconf.rb on banana001 to generate host declarations.
  }
}
